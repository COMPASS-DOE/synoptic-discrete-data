issue_cups <- c("13")
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`)) %>%  # leave unchanged if no match
#  Run_Date = mdy_hm(Run_Time)) &>&
Run_Date = format(mdy_hm(Run_Time), "%m-%d-Y")
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`)) %>%  # leave unchanged if no match
#  Run_Date = mdy_hm(Run_Time)) &>&
Run_Date = format(mdy_hm(Run_Time), "%m-%d-Y")
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`), %>%  # leave unchanged if no match
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-Y"))
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-%Y"))
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_NOx <- stds_NOx %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0222,
Sample_Name == "Standard 91" ~ 0.05,
Sample_Name == "Standard 92" ~ 0.1,
Sample_Name == "Standard 93" ~ 0.25,
Sample_Name == "Standard 94" ~ 0.5,
Sample_Name == "Standard 95" ~ 0.75,
Sample_Name == "Standard 96" ~ 1.0,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-%Y")) %>%
filter(!Sample_Name %in% c("Nitrate Standard" , "Nitrite Standard"))
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
stds_combo <- bind_rows(stds_NOx, stds_NH3, stds_PO4)
std_curve_combo <- bind_rows(std_curve_NOx_1, std_curve_NH3_1, std_curve_PO4_1)
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
std_curve_NOx <- ggplot(stds_NOx, aes(x = Conc, y = Absorbance)) +
geom_point(size=3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2, raw = TRUE), color = "coral") +
theme_bw() +
facet_wrap(Run_Date)
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
std_curve_NOx <- ggplot(stds_NOx, aes(x = Conc, y = Absorbance)) +
geom_point(size=3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2, raw = TRUE), color = "coral") +
theme_bw() +
facet_wrap(stds_NOx$Run_Date)
labs(x="Concentration (ppm)",
y="Absorbance",
title = "NOx Standard Curve")+
annotate("text", x = 0.75, y = max(stds_NOx$Absorbance),
label = paste("r^2 =", round(NOx_r2, 4)),
color = "black", size = 4)
print(std_curve_NOx)
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
std_curve_NOx <- ggplot(stds_NOx, aes(x = Conc, y = Absorbance)) +
geom_point(size=3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2, raw = TRUE), color = "coral") +
theme_bw() +
facet_wrap(~Run_Date)
labs(x="Concentration (ppm)",
y="Absorbance",
title = "NOx Standard Curve")+
annotate("text", x = 0.75, y = max(stds_NOx$Absorbance),
label = paste("r^2 =", round(NOx_r2, 4)),
color = "black", size = 4)
print(std_curve_NOx)
#let you know which section you are in
cat("Setup")
#set the run date & user name
run_date <- "20230603"
sample_year <- 2023
sample_month <- 04
user <- "Stephanie Wilson"
#identify the files you want to read in
NOx_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NOx_April2023_1.csv"
NH3_PO4_file_1 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_April2023_1.csv"
#  NH3_PO4_file_2 <- "Raw Data/SEAL_COMPASS_Synoptic_NH3_PO4_Aug2023_2.csv"
#combine files if multople
#  NH3_PO4_file <- rbind(NH3_PO4_file_1, NH3_PO4_file_2)
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_Synoptic_QAQC_Log_2023.csv"
final_path <- "Processed Data/COMPASS_Synoptic_Nutrients_202304.csv"
#record any notes about the run or anything other info here:
Notes <- "There are two sample names we suspect were input incorrectly, they are listed below and have been checked against metadata"
#duplicate sample names to be changed
#list the sample iDs that are messed up and create a list with the cup identifier as well so that we can change them below
wrong_names <- c("GCW_202304_TR_LysC_45cm", "GCW_202304_TR_LysA_20cm")
wrong_cups <- c("20", "13")
right_names <- c("GCW_202304_TR_LysB_45cm", "GCW_202304_TR_LysA_10cm")
#can't determine from metadata - for now unsure
issue_names <- c("GCW_202304_TR_LysA_20cm")
#couldn't tell which onethis is from the metadata, no A_10cm which is what we thought marked on the sheet, need to check sample vials in            freezer to see if we have a A_10cm from GCW_TR to be sure
issue_cups <- c("13")
cat("Import Data")
#setwd("/Raw Data")
#set working directory
#could be from google drive or local drive etc.
path <- ("file path")
#Read in Raw Data
dat_NOx_1 <- readr::read_csv(NOx_file_1)
dat_NH3_PO4_1 <- readr::read_csv(NH3_PO4_file_1)
#dat_NH3_PO4_2 <- readr::read_csv(NH3_PO4_file_2)
# Combining Files
#dat_NH3_PO4 <- bind_rows(dat_NH3_PO4_1, dat_NH3_PO4_2)
df_combo <- bind_rows(dat_NOx_1, dat_NH3_PO4_1)
# Rename columns
df_combo_rename <- df_combo %>%
rename('Conc' = ...6,
'Absorbance' = ...7,
'Dilution' = ...9,
'Sample_Name' = ...4,
'Test' = ...13,
'Run_Time' = ...15,
'Unit' = ...12)
#making list to remove columns
cols_to_remove <- c("RUNSTARTED", "...5", "...8", "...10", "...11", "...14")
#Removing columns
df_all <- df_combo_rename %>%
select(-all_of(cols_to_remove)) %>%
select(!c(1,2))%>%
select(!c(8,9))
#Checking column headers
head(df_all)
cat("Assess Standard Curves")
#CHECK SEAL METHOD FOR WHAT THE SETTING FOR THE EQUATIONS USED TO CALCULARE THE CONCENTRATIONS
#maybe nonlinear model or intercept settigns
#Pull out standards
stds <- df_all %>%
filter(str_detect(Sample_Name, "Standard"))
#Making standards dataframe based on the test
stds_NOx <- stds[stds$Test == "Vanadium NOx", ]
stds_NH3 <- stds[stds$Test == "Ammonia 2", ]
stds_PO4 <- stds[stds$Test == "o-PHOS 0.3", ]
#Inputting Standard Values Based on Protocol (LINK PROTOCOL)
stds_NOx <- stds_NOx %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0222,
Sample_Name == "Standard 91" ~ 0.05,
Sample_Name == "Standard 92" ~ 0.1,
Sample_Name == "Standard 93" ~ 0.25,
Sample_Name == "Standard 94" ~ 0.5,
Sample_Name == "Standard 95" ~ 0.75,
Sample_Name == "Standard 96" ~ 1.0,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-%Y")) %>%
filter(!Sample_Name %in% c("Nitrate Standard" , "Nitrite Standard"))
#ID x and y
x1 <- stds_NOx$Absorbance
y1 <- stds_NOx$Conc
stds_NH3 <- stds_NH3 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard .0389" ~ 0.0389,
Sample_Name == "Standard .1000" ~ 0.1,
Sample_Name == "Standard .2000" ~ 0.2,
Sample_Name == "Standard .5000" ~ 0.5,
Sample_Name == "Standard 1.0000" ~ 1.0,
Sample_Name == "Standard 1.5000" ~ 1.5,
Sample_Name == "Standard 2.0000" ~ 2,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-%Y"))
# identifying x and y
x2 <- stds_NH3$Absorbance
y2 <- stds_NH3$Conc
stds_PO4 <- stds_PO4 %>%
mutate(`Conc` = case_when(
Sample_Name == "Standard 0" ~  0.0,
Sample_Name == "Standard 1" ~  0.0,
Sample_Name == "Standard 90" ~ 0.0060,
Sample_Name == "Standard 91" ~ 0.0150,
Sample_Name == "Standard 92" ~ 0.0300,
Sample_Name == "Standard 93" ~ 0.0750,
Sample_Name == "Standard 94" ~ 0.1500,
Sample_Name == "Standard 95" ~ 0.2250,
Sample_Name == "Standard 96" ~ 0.3000,
TRUE ~ `Conc`),  # leave unchanged if no match
Run_Date = format(mdy_hm(Run_Time), "%m-%d-%Y"))
#ID x and y
x3 <- stds_PO4$Absorbance
y3 <- stds_PO4$Conc
#generating line of best fit aka standard curves
#NOx
# Fit the quadratic model
quad_reg_NOx <- lm(y1 ~ x1 + I(x1^2))
#quad_reg_NOx <- lm(Absorbance ~ Conc + Conc2, data = stds_NOx)
NOx_coefs <- coef(quad_reg_NOx)                        # intercept and slopes
NOx_r2 <- summary(quad_reg_NOx)$r.squared              # R squared
# Store in a clean dataframe
std_curve_NOx_1 <- data.frame(
Test = "NOx",
Intercept = NOx_coefs["(Intercept)"],
Conc_Coeff = NOx_coefs["Conc"],
Conc2_Coeff = NOx_coefs["Conc2"],
R_squared = NOx_r2
)
#NH3
lin_reg_NH3 <- lm(y2 ~ x2)
NH3_coefs <- coef(lin_reg_NH3)                        # intercept and slope
NH3_r2 <- summary(lin_reg_NH3)$r.squared              # R squared
# Store in a clean dataframe
std_curve_NH3_1 <- data.frame(
Test = "NH3",
Intercept = NH3_coefs["(Intercept)"],
Slope = NH3_coefs[2],
R_squared = NH3_r2
)
#PO4
lin_reg_PO4 <- lm(y3 ~ x3)
PO4_coefs <- coef(lin_reg_PO4)                        # intercept and slope
PO4_r2 <- summary(lin_reg_PO4)$r.squared              # R squared
# Store in a clean dataframe
std_curve_PO4_1 <- data.frame(
Test = "PO4",
Intercept = PO4_coefs["(Intercept)"],
Slope = PO4_coefs[2],
R_squared = PO4_r2
)
#Combining standards & curve data frames
stds_combo <- bind_rows(stds_NOx, stds_NH3, stds_PO4)
std_curve_combo <- bind_rows(std_curve_NOx_1, std_curve_NH3_1, std_curve_PO4_1)
