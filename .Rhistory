theme_classic() + labs(x= " ", y="C (mg/L)", title="Cl: Green = Within Range of Curve") +
theme(legend.position="none") +
theme(axis.text.x = element_blank())
so4_samples_flag <-  ggplot(data = dat_flagged, aes(x = sample_name, y = SO4_ppm_undil, fill=SO4_flag)) +
geom_bar(stat = 'identity') +
scale_fill_manual(values=c("green", "red"))+
theme_classic() + labs(x= " ", y="N (mg/L)", title="SO4: Green = Within Range of Curve") +
theme(legend.position="none") +
theme(axis.text.x = element_blank())
ggarrange(cl_samples_flag, so4_samples_flag, nrow=1, ncol=2)
# Chunk 13
cat("Check Sample IDs with Metadata")
#remove duplicates from the sample dataframe bc we are just taking the first dup run
all_data_flagged <- dat_flagged %>%
filter(!str_detect(sample_ID, "dup")) %>%
filter(!str_detect(sample_ID, "Lab Blank")) %>%
mutate(sample_ID = sub("^[^_]+_", "", sample_ID))
#select(!Excess_Info)
#check to see if all samples are present in the metadata
all_data_flagged$sample_ID <- toupper(all_data_flagged$sample_ID)
dionex_metadata$Cl_SO4_ID <- toupper(dionex_metadata$Cl_SO4_ID)
all_present <- all(all_data_flagged$sample_ID %in% dionex_metadata$Cl_SO4_ID)
if (all_present) {
message("All sample IDs are present in metadata.")
} else {
message("Some sample IDs are missing from metadata.")
# Optional: Which ones are missing?
missing_ids <- setdiff(all_data_flagged$sample_ID, dionex_metadata$Cl_SO4_ID)
print(missing_ids)
}
dionex_metadata_selected <- dionex_metadata %>%
select(Cl_SO4_ID, Year, Month, Day, Depth_cm, Lysimeter, Time..24hr., Time.Zone_EDT.EST,  Field.Notes)
#merge metadata with sample run data
merged_data <- all_data_flagged %>%
left_join(dionex_metadata_selected, by = c("sample_ID" = "Cl_SO4_ID"))
# Chunk 14: Visualize Data
cat("Visualize Data")
#Plot samples to get a first look at concentrations (sanity check)
data_plotting <- merged_data
IDs <- data.frame(do.call('rbind', strsplit(as.character(data_plotting$sample_name),'_',fixed=TRUE)))
colnames(IDs) <- c("Sample_Number", "Site_Code", "Date" ,"Zone")
IDs <- IDs[c("Sample_Number", "Site_Code", "Date" ,"Zone")]
head(IDs)
#rejoin them to the dataframe
data_plotting <- cbind(IDs, data_plotting)
#group the data for plotting
data_plotting <- data_plotting %>%
group_by(Site_Code) %>%
mutate(row_num = factor(row_number())) %>%  # create row_num as factor per group
ungroup()
#Plot data and change colors based on flags to check it:
viz_cl_plot <- ggplot(data_plotting, aes(x = factor(row_num), y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
cat("Export Processed Data")
#Prepare data to be exported - if there is anything else to add
#Add any necessary identifiers to the samples  ### VERY IMPORTANT AND STANDARD FOR PROJECT ####
#example read in sample IDs list and merge
#create required ID columns in R, etc.
final_data <- merged_data %>%
mutate(
Project = "COMPASS: Synoptic",   # new column with same value on every row
Region = "CB",
Run_notes = run_notes     # new column with notes about the run
)
colnames(final_data)
cat("Visualize Data")
#Plot samples to get a first look at concentrations (sanity check)
data_plotting <- merged_data
IDs <- data.frame(do.call('rbind', strsplit(as.character(data_plotting$sample_name),'_',fixed=TRUE)))
colnames(IDs) <- c("Sample_Number", "Site_Code", "Date" ,"Zone")
IDs <- IDs[c("Sample_Number", "Site_Code", "Date" ,"Zone")]
head(IDs)
View(IDs)
#rejoin them to the dataframe
data_plotting <- cbind(IDs, data_plotting)
#group the data for plotting
data_plotting <- data_plotting %>%
group_by(Site_Code) %>%
mutate(row_num = factor(row_number())) %>%  # create row_num as factor per group
ungroup()
#Plot data and change colors based on flags to check it:
viz_cl_plot <- ggplot(data_plotting, aes(x = factor(row_num), y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
#Plot data and change colors based on flags to check it:
viz_cl_plot <- ggplot(data_plotting, aes(x = row_num, y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
#group the data for plotting
data_plotting <- data_plotting %>%
group_by(Site_Code, Zone) %>%
mutate(row_num = factor(row_number())) %>%  # create row_num as factor per group
ungroup()
#Plot data and change colors based on flags to check it:
viz_cl_plot <- ggplot(data_plotting, aes(x = factor(row_num), y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
#group the data for plotting
data_plotting <- data_plotting %>%
group_by(Site_Code) %>%
mutate(row_num = factor(row_number())) %>%  # create row_num as factor per group
ungroup()
#Plot data and change colors based on flags to check it:
viz_cl_plot <- ggplot(data_plotting, aes(x = factor(row_num), y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
#Plot data and change colors based on zone:
viz_cl_plot <- ggplot(data_plotting, aes(x = Depth_cm, y = Cl_ppm, fill = Zone)) +
geom_boxplot(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = Depth_cm, y = SO4_ppm, fill = Zone)) +
geom_boxplot(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
#Plot data and change colors based on zone:
viz_cl_plot <- ggplot(data_plotting, aes(x = Depth_cm, y = Cl_ppm, fill = Zone)) +
geom_boxplot() +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = Depth_cm, y = SO4_ppm, fill = Zone)) +
geom_boxplot() +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
# theme(legend.position = "none") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
cat("Export Processed Data")
#Prepare data to be exported - if there is anything else to add
#Add any necessary identifiers to the samples  ### VERY IMPORTANT AND STANDARD FOR PROJECT ####
#example read in sample IDs list and merge
#create required ID columns in R, etc.
final_data <- merged_data %>%
mutate(
Project = "COMPASS: Synoptic",   # new column with same value on every row
Region = "CB",
Run_notes = run_notes     # new column with notes about the run
)
colnames(final_data)
final_data <- final_data %>%
rename(
Time = Time..24hr.,
Time_Zone = Time.Zone_EDT.EST,
Replicate = Lysimeter,
Sample_ID = sample_ID,
Field_notes = Field.Notes
# add more rename pairs as needed
) %>%
select(
Sample_ID, SO4_mM, Cl_mM, salinity, Cl_flag, SO4_flag, Year, Month, Day, Depth_cm, Replicate, Time, Time_Zone, Run_notes, Field_notes
# list columns in the order you want them
)
head(final_data)
#will put final data in processed data folder
#Write out data frame
write.csv(final_data, processed_file_name)
#file path and name of processed data file
processed_file_name = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Processed Data/COMPASS_SynopticCB_PW_Processed_Cl_SO4_202311.csv"
cat("Export Processed Data")
#Prepare data to be exported - if there is anything else to add
#Add any necessary identifiers to the samples  ### VERY IMPORTANT AND STANDARD FOR PROJECT ####
#example read in sample IDs list and merge
#create required ID columns in R, etc.
final_data <- merged_data %>%
mutate(
Project = "COMPASS: Synoptic",   # new column with same value on every row
Region = "CB",
Run_notes = run_notes     # new column with notes about the run
)
colnames(final_data)
final_data <- final_data %>%
rename(
Time = Time..24hr.,
Time_Zone = Time.Zone_EDT.EST,
Replicate = Lysimeter,
Sample_ID = sample_ID,
Field_notes = Field.Notes
# add more rename pairs as needed
) %>%
select(
Sample_ID, SO4_mM, Cl_mM, salinity, Cl_flag, SO4_flag, Year, Month, Day, Depth_cm, Replicate, Time, Time_Zone, Run_notes, Field_notes
# list columns in the order you want them
)
head(final_data)
#will put final data in processed data folder
#Write out data frame
write.csv(final_data, processed_file_name)
View(final_data)
#identify section
cat("Setup Information")
###### Run information - PLEASE CHANGE
Date_Run = "2023-09-05"  #Date that instrument was run
Run_by = "Unknown"  #Instrument user
Script_run_by = "Zoe Read" #Code user
run_notes = "Samples missing from metadata: MSM_202311_UP_LYSC_45CM MSM_202311_WC_LYSB_45CM MSM_202311_WC_LYSC_45CM      MSM_202311_UP_RHZ_SF_TREE_1 MSM_202311_UP_RHZ_SF_TREE_2   MSM_202311_UP_RHZ_SF_TREE_3   MSM_202311_UP_RHZ_SF_TREE_4  MSM_202311_UP_RHZ_SF_TREE_6   MSM_202311_UP_RHZ_SF_TREE_7   MSM_202311_UP_RHZ_SF_TREE_8   MSM_202311_TR_RHZ_SF_TREE_   MSM_202311_TR_RHZ_SF_TREE_2   MSM_202311_TR_RHZ_SF_TREE_3 MSM_202311_TR_RHZ_SF_TREE_4  MSM_202311_TR_RHZ_SF_TREE_5  MSM_202311_TR_RHZ_SF_TREE_6  MSM_202311_TR_RHZ_SF_TREE_7   MSM_202311_TR_RHZ_SF_TREE_8 MSM_202311_WC_RHZ_SF_COLLAR_1 MSM_202311_WC_RHZ_SF_COLLAR_2 MSM_202311_WC_RHZ_SF_COLLAR_3 MSM_202311_WC_RHZ_SF_COLLAR_4 MSM_202311_WC_RHZ_SF_COLLAR_5 MSM_202311_WC_RHZ_LYSA
MSM_202311_WC_RHZ_LYSC. 118_MSM_202311_TR_RHZ_SF_Tree_1 value above cal curve for SO4, but only slightly. Missing UP Zone from GCW?" #any notes from the run
samples <- c("GCW", "GWI", "MSM", "SWH") #whatever identifies your samples within the same names
samples_pattern <- paste(samples, collapse = "|")
#samples_pattern <- "GCW" #use this instead of the line above if you have only one site code
chks_name = "Check Standard"  #what did you name your check standards?
###### File Names - PLEASE CHANGE
#file path and name for raw summary data file
raw_file_name_cl = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Raw Data/COMPASS_Synoptic_CB_MonMon_202311_Cl.txt"
raw_file_name_so4 = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Raw Data/COMPASS_Synoptic_CB_MonMon_202311_SO4.txt"
#file path and name of processed data file
processed_file_name = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Processed Data/COMPASS_SynopticCB_PW_Processed_Cl_SO4_202311.csv"
###### Log Files - PLEASE CHECK
#downloaded metadata csv - downloaded from Google drive as csv for this year
Raw_Metadata = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Raw Data/COMPASS_SynopticCB_PW_SampleLog_2023.csv"
#qaqc log file path for this year
Log_path = "Porewater/Sulfate_Chloride/Synoptic_CB/2023/Raw Data/COMPASS_Synoptic_Cl_SO4_QAQClog_2023.csv"
#Packages that are required
lapply(c(
"dplyr", "ggplot2", "ggpubr", "stringr",
"purrr", "tidyverse", "here", "broom", "tibble",
"googledrive", "googlesheets4", "data.table",
"matrixStats", "gridExtra", "grid", "tidyverse"),
library, character.only = TRUE)
#Link to the protocol used for analysis
#steph will add this soon
#Any coefficients / constants that are needed for calculations
cl_mw <- 35.45     #molecular weight of Chloride: 35.45
s_mw <- 32.06      #molecular weight of sulfur: 32.06
#Flags for Dionex
r2_cutoff = 0.98  #this is the level below which we want to rerun or consider a curve
chk_flag_std_s = 10 #this is the maximum cv allowed for sulfate check standards
chk_flag_std_cl = 5   #this is the maximum cv allowed for chloride check standards
chk_flag_dups = 10 #this is the maximum cv allowed for duplicates
chks_flag = 0.80 #this is the percent of chks we want to have a CV less than the max allowable cv
#blank_flag - calculated based on samples later in this code as lower 25% quantile of sample concentrations
#Standard concentrations - Update if running different standard curve:
standards <- tibble(
sample_ID = c("Standard 1", "Standard 2", "Standard 3", "Standard 4", "Standard 5"),
SO4_std_conc = c(0.5, 1.0, 2.0, 10, 20),
Cl_std_conc = c(5, 10, 20, 100, 200))
#Spike concentration calc
spk_std <- (250/s_mw)    # in mM
spkvol <- 10             # in uL
spkvol <- spkvol/1000000 # in L
#spike for these samples was 10uL of the 250 Âµg/mL standard
spk_Conc <- (spk_std)*spkvol # mmoles of SO4
#Top standard Concentrations- Update if running different standard curve:
top_std_cl = 200
top_std_so4 = 20
#Set time zone
common_tz = "Etc/GMT+5"
Sys.setenv(TZ = "America/New_York")
#plot indicators
site_order <- c('GCW', 'MSM', 'GWI', 'SWH')
plot_order <- c('UP', 'SWAMP', 'TR', 'WC', 'SW')
plot_colors <- c("#20063B", "darkgrey", "#FFBC42", "#419973", "#25ABE6" )
#read in the raw metadata file
raw_metadata <- read.csv(Raw_Metadata)
#make a new columns in the metadata with important info:
metadata <- raw_metadata %>%
mutate(Depth = paste0(Depth_cm, "cm")) %>%
mutate(LysID = paste0("Lys", Lysimeter)) %>%
mutate(YearMonth = sprintf("%d%02d", Year, Month))  %>%
mutate(Zone = case_when(
`Transect.Location` == "Transition" ~ "TR",
`Transect.Location` == "Wetland"    ~ "WC",
`Transect.Location` == "Upland"     ~ "UP",
`Transect.Location` == "Surface Water" ~ "SW",
TRUE                 ~ `Transect.Location`    # keep original value if no match
))
#Create IDs from what was collected for comparison later
metadata <- metadata %>%
mutate(Cl_SO4_ID = ifelse(SO4 == "x",
paste(Site,
YearMonth,
Zone,
LysID,
Depth,
sep = "_"),
NA),  )
#Change the SW lines because they don't have lysimeters or a depth
metadata <- metadata %>%
mutate(
Cl_SO4_ID = if_else(
Zone == "SW",
# Modify the string:
Cl_SO4_ID %>%
str_replace("_LysA", "_A") %>%                    # Replace "_LysA" with "_A"
str_replace("_LysB", "_B") %>%                    # Replace "_LysB" with "_B"
str_replace("_LysC", "_C") %>%                    # Replace "_LysC" with "_C"
str_replace("_0cm$", ""),                          # Remove trailing "_0cm"
Cl_SO4_ID  # else keep original
)
)
#Take out the columns and rows that are not relevant
dionex_metadata <- metadata %>%
select(Cl_SO4_ID, Year, Month, Day, YearMonth, Site, Zone, Lysimeter, LysID, Depth_cm,
Depth, Time..24hr., Time.Zone_EDT.EST, Field.Notes, ) %>%
# only keep specific columns
filter(!is.na(Cl_SO4_ID) & Cl_SO4_ID != "")  # remove missing/blank Cl_SO4_ID rows
head(dionex_metadata)
#Plot data and change colors based on Zone:
viz_cl_plot <- ggplot(data_plotting, aes(x = row_num, y = Cl_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = " ", y = "Cl (mg/L)", title = "Samples: Chloride") +
scale_x_discrete(drop = TRUE)
viz_so4_plot <-  ggplot(data_plotting, aes(x = row_num, y = SO4_ppm, fill = Zone)) +
geom_bar(stat = "identity", position = position_dodge2(preserve = "single")) +
facet_grid(~ Site_Code, scales="free_x") +
scale_fill_manual(values = c(
"UP" = "#20063B",
"UPCON" = "pink",
"TR" = "#FFBC42",
"SWAMP" = "darkgrey",
"WC" = "#419973",
"SW" = "#25ABE6"
)) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = " ", y = "SO4 (mg/L)", title = "Samples: SO4") +
scale_x_discrete(drop = TRUE)
ggarrange(viz_cl_plot, viz_so4_plot, nrow=2, ncol=1)
